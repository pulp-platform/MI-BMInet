Neural Network Tools for STM32 v1.1.0 (AI tools v4.1.0)
Created date    : 2019-12-22 02:34:54

Exec/report summary (validate dur=2108.231s err=0)
------------------------------------------------------------------------------------------------------------------------
model file      : /home/batom/Embedded_ML_EEG/git_semesterend/embedded-machine-learning-on-eeg-data-analysis/mcu/models/4class_19ch_freqfactor5.h5
type            : keras (keras_dump)
c_name          : network
compression     : None
quantize        : None
L2r error       : 1.19006565e-07 (expected to be < 0.01)
workspace dir   : /tmp/mxAI_workspace76210871630464130265689656221517
output dir      : /home/batom/.stm32cubemx/stm32ai_output
vinput files    : /home/batom/Embedded_ML_EEG/MCU/data/val_4class_19ch_freq5_set.npz
voutput files   : /home/batom/Embedded_ML_EEG/MCU/data/val_4class_last21subjects_labels.npz

model_name      : class_19ch_freqfactor5
model_hash      : 1bbc9c7d0fb7d43fc8593835b286a768
input           : input_1 [1,824 items, 7.12 KiB, ai_float, FLOAT32]
input (total)   : 7.12 KiB
output          : softmax [4 items, 16 B, ai_float, FLOAT32]
output (total)  : 16 B
params #        : 1,988 items (7.77 KiB)
macc            : 1,925,668
rom (ro)        : 7,856 (7.67 KiB) -1.21%
ram (rw) wb+io  : 65,280 + 7,312 (63.75 KiB + 7.14 KiB)

------------------------------------------------------------------------------------------------------------------------
id  layer (type)                       output shape      param #     connected to             macc           rom                
------------------------------------------------------------------------------------------------------------------------
0   input_1 (Input)                    (19, 96, 1)                                                                              
------------------------------------------------------------------------------------------------------------------------
1   conv2d_1 (Conv2D)                  (19, 96, 8)       1,024       input_1                  1,867,784      4,128              
------------------------------------------------------------------------------------------------------------------------
2   batch_normalization_1 (ScaleBias)  (19, 96, 8)       16          conv2d_1                                                   
------------------------------------------------------------------------------------------------------------------------
3   depthwise_conv2d_1 (Conv2D)        (1, 96, 16)       304         batch_normalization_1    49,168         1,280              
------------------------------------------------------------------------------------------------------------------------
4   batch_normalization_2 (ScaleBias)  (1, 96, 16)       32          depthwise_conv2d_1                                         
------------------------------------------------------------------------------------------------------------------------
5   activation_1 (Nonlinearity)        (1, 96, 16)                   batch_normalization_2                                      
------------------------------------------------------------------------------------------------------------------------
6   average_pooling2d_1 (Pool)         (1, 12, 16)                   activation_1                                               
------------------------------------------------------------------------------------------------------------------------
8   separable_conv2d_1 (Conv2D)        (1, 12, 16)       256         average_pooling2d_1      3,072          1,088 (i)          
    separable_conv2d_1_conv2d (Conv2D) (1, 12, 16)       256         separable_conv2d_1       5,520          1,088              
------------------------------------------------------------------------------------------------------------------------
9   batch_normalization_3 (ScaleBias)  (1, 12, 16)       32          separable_conv2d_1_conv2                                   
------------------------------------------------------------------------------------------------------------------------
10  activation_2 (Nonlinearity)        (1, 12, 16)                   batch_normalization_3                                      
------------------------------------------------------------------------------------------------------------------------
11  average_pooling2d_2 (Pool)         (1, 1, 16)                    activation_2                                               
------------------------------------------------------------------------------------------------------------------------
13  flatten (Reshape)                  (16,)                         average_pooling2d_2                                        
------------------------------------------------------------------------------------------------------------------------
14  dense (Dense)                      (4,)              68          flatten                  64             272                
------------------------------------------------------------------------------------------------------------------------
15  softmax (Nonlinearity)             (4,)                          dense                    60                                
------------------------------------------------------------------------------------------------------------------------
class_19ch_freqfactor5 p=1988(7.77 KBytes) macc=1925668 rom=7.67 KBytes ram=63.75 KBytes -1.21%

 
Complexity/l2r error per-layer - macc=1,925,668 rom=7,856
------------------------------------------------------------------------------------------------------------------------
id  layer (type)                       macc                          rom                           l2r error                    
------------------------------------------------------------------------------------------------------------------------
1   conv2d_1 (Conv2D)                  |||||||||||||||||||||  97.0%  |||||||||||||||||||||  52.5%                               
3   depthwise_conv2d_1 (Conv2D)        |                       2.6%  |||||||                16.3%                               
8   separable_conv2d_1 (Conv2D)        |                       0.2%  ||||||                 13.8%                               
8   separable_conv2d_1_conv2d (Conv2D) |                       0.3%  ||||||                 13.8%                               
14  dense (Dense)                      |                       0.0%  ||                      3.5%                               
15  softmax (Nonlinearity)             |                       0.0%  |                       0.0%  1.19006565e-07 *             
------------------------------------------------------------------------------------------------------------------------


ON-DEVICE STM32 execution ("network", None, 115200)..

<Stm32com id=0x7ff4c040e2e8 - CONNECTED(/dev/ttyACM0/115200) devid=0x415/STM32L4x6xx msg=2.1>
 0x415/STM32L4x6xx @80MHz/80MHz (FPU is present) lat=4 ART: ICen DCen
 found network(s): ['network']
 description    : 'network' float32,(19, 96, 1)-[6]->float32,(1, 1, 4) macc=1925668 rom=7.67KiB ram=63.75KiB
 tools versions : rt=(4, 1, 0) tool=(4, 1, 0)/(1, 3, 0) api=(1, 1, 0) "Sun Dec 22 01:59:32 2019"

Results for 1764 inference(s) @80/80MHz (macc:1925668)
 device      : 0x415/STM32L4x6xx @80MHz/80MHz (FPU is present) lat=4 ART: ICen DCen
 duration    : 171.847 ms (average)
 CPU cycles  : 13747764 (average)
 cycles/MACC : 7.14 (average for all layers)
 c_nodes     : 6

Clayer  id  desc                          oshape          fmt       ms        
--------------------------------------------------------------------------------
0       1   10004/(2D Convolutional)      (19, 96, 8)     float32   153.331   
1       3   10011/(Merged Conv2d / Pool)  (1, 12, 16)     float32   16.880    
2       8   10004/(2D Convolutional)      (1, 12, 16)     float32   0.454     
3       8   10011/(Merged Conv2d / Pool)  (1, 1, 16)      float32   1.139     
4       14  10005/(Dense)                 (1, 1, 4)       float32   0.019     
5       15  10009/(Nonlinearity)          (1, 1, 4)       float32   0.023     
                                                                    171.847 (total)


Accuracy report for the generated stm32 C-model
----------------------------------------------------------------------------------------------------
NOTE: Computed against the provided ground truth values

acc=63.10%, rmse=0.3601, mae=0.2770

4 classes (1764 samples)
----------------------------
C0        280  28   68   65  
C1        29   266  56   90  
C2        59   41   288  53  
C3        43   57   62   279 

Accuracy report for the reference model
----------------------------------------------------------------------------------------------------
NOTE: Computed against the provided ground truth values

acc=63.10%, rmse=0.3601, mae=0.2770

4 classes (1764 samples)
----------------------------
C0        280  28   68   65  
C1        29   266  56   90  
C2        59   41   288  53  
C3        43   57   62   279 

Cross accuracy report (reference vs C-model)
----------------------------------------------------------------------------------------------------
NOTE: the output of the reference model is used as ground truth value

acc=100.00%, rmse=0.0000, mae=0.0000

4 classes (1764 samples)
----------------------------
C0        411   .    .    .  
C1         .   392   .    .  
C2         .    .   474   .  
C3         .    .    .   487 


Evaluation report (summary)
--------------------------------------------------
Mode                acc       rmse      mae      
--------------------------------------------------
stm32 C-model       63.1%     0.360106  0.277011 
original model      63.1%     0.360106  0.277011 
X-cross             100.0%    0.000000  0.000000 

L2r error : 1.19006565e-07 (expected to be < 0.01)
